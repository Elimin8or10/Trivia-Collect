<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trivia Pack Game</title>
<style>
body{
  font-family: system-ui, Arial, sans-serif;
  margin:0; padding:12px;
  background: linear-gradient(135deg,#f0f8ff,#ffe4e1);
  display:flex; flex-direction:column; align-items:center;
}
h1{font-size:1.6rem; margin-bottom:6px; text-align:center;}
button{
  padding:10px 14px; margin:4px;
  font-size:1rem; border:none; border-radius:10px;
  transition: all 0.3s;
  cursor: default; background:#222; color:white;
}
button:hover{transform:translateY(-2px);}
#resetBtn{background:#d9534f; cursor:pointer;}
#openPackBtn.gold{background:#ffd700;color:#333; cursor:pointer; animation: glow 1s infinite alternate;}
@keyframes glow{0%{box-shadow:0 0 5px #ffd700;}100%{box-shadow:0 0 15px #ffd700;}}

#favoriteSpot{
  padding:6px 12px; margin:6px 0;
  font-weight:bold;
  background:#fff; border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,0.15);
  width:90%; max-width:400px;
  text-align:center;
}

#trivia,#answers,#result,#animation{
  margin:6px auto;
  max-width:400px; width:90%;
}
#answers button{width:100%; margin:4px 0; background:#444; cursor:pointer;}
#answers button.correct{background:#28a745; animation:flashGreen 0.5s;}
#answers button.wrong{background:#dc3545; animation:flashRed 0.5s;}
@keyframes flashGreen{0%{background:#28a745;}50%{background:#5cd65c;}100%{background:#28a745;}}
@keyframes flashRed{0%{background:#dc3545;}50%{background:#ff6666;}100%{background:#dc3545;}}

#inventoryWrapper{margin-top:12px; width:95%; max-width:480px;}
#sortBtn{background:#5bc0de; cursor:pointer; margin-bottom:6px;}
#rarityChances{margin:4px 0;}
.rarityLine{display:flex;justify-content:space-between;padding:2px 6px;border-radius:6px;color:black;margin:2px 0;font-weight:bold;font-size:0.85rem;}
#cardList{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
  gap:8px;
  max-height:50vh;
  overflow-y:auto;
}
.rarityHeader{grid-column:1/-1;font-weight:700;margin:8px 0;text-align:left;}
.card{
  padding:8px; border-radius:10px;
  font-weight:bold; display:flex;
  justify-content:center; align-items:center;
  text-align:center;
  aspect-ratio:1/1; cursor:default;
  transition:transform 0.3s, box-shadow 0.3s;
  position:relative;
}
.card.interactive{cursor:pointer;}
.card.interactive:hover{transform:translateY(-3px) scale(1.03); box-shadow:0 4px 12px rgba(0,0,0,0.25);}
.card.new{animation:pulse 0.6s;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.08);}100%{transform:scale(1);}}

/* CARD COLORS */
.card.Garbage{background:#ccc;color:#333}
.card.Common{background:#a8d5a2;color:#333}
.card.Uncommon{background:#78c0e0;color:#fff}
.card.Normal{background:#b493ff;color:#fff}
.card.Rare{background:#ffb347;color:#333}
.card.Unusual{background:#ff7f50;color:#fff}
.card.Epic{background:#ff5c8a;color:#fff}
.card.Spicy{background:#ff4040;color:#fff}
.card.Legendary{background:#ffd700;color:#333}
.card.Mystical{background:linear-gradient(135deg,#6ecbff,#3478f6);color:#fff}
.card.Magic{background:linear-gradient(135deg,#ff99ff,#ff33cc);color:#fff}
.card.Artifact{background:linear-gradient(135deg,#ff9900,#ff3300);color:#fff}

/* CONFETTI */
.confetti-piece{
  position:fixed; width:8px; height:8px; pointer-events:none;
  opacity:0.9; animation:fall 2s linear forwards;
  border-radius:50%;
}
@keyframes fall{0%{transform:translateY(-10px) rotate(0deg);}100%{transform:translateY(100vh) rotate(360deg);opacity:0;}}
</style>
</head>
<body>

<h1>Trivia Pack Game</h1>
<div id="favoriteSpot">No favorite selected</div>

<div id="trivia"></div>
<div id="answers"></div>
<div id="result"></div>
<div id="animation"></div>

<div style="margin:6px 0;">
  <button id="openPackBtn">üéÅ Open Pack</button>
  <button id="resetBtn">Reset Game</button>
</div>

<div id="inventoryWrapper">
  <button id="sortBtn" onclick="toggleSort()">Sort by: Rarity</button>
  <div id="rarityChances"></div>
  <div id="cardList"></div>
</div>

<div id="stats"></div>

<script>
// ===== DATA =====
const rarities=["Garbage","Common","Uncommon","Normal","Rare","Unusual","Epic","Spicy","Legendary","Mystical","Magic","Artifact"];
const rarityOdds=[{r:"Garbage",c:10},{r:"Common",c:26},{r:"Uncommon",c:15},{r:"Normal",c:12},{r:"Rare",c:10},{r:"Unusual",c:9},{r:"Epic",c:8},{r:"Spicy",c:7},{r:"Legendary",c:6},{r:"Mystical",c:5},{r:"Magic",c:4},{r:"Artifact",c:1}];
let inventory=JSON.parse(localStorage.getItem("inventory"))||[];
let favorite=JSON.parse(localStorage.getItem("favorite"))||null;
let correctAnswer="",canOpenPack=false,opening=false,sortMode="rarity";

const firstWords=["Golden","Fluffy","Crystal","Magic","Tiny","Giant","Laser","Pancake","Rainbow","Sparkling"];
const secondWords=["Chair","Wheelchair","Laptop","Drill","Umbrella","Backpack","Piano","Toaster","Microscope"];

// ===== UTIL =====
function save(){ localStorage.setItem("inventory",JSON.stringify(inventory)); localStorage.setItem("favorite",JSON.stringify(favorite)); }
function rollRarity(){ let roll=Math.random()*100,t=0; for(const o of rarityOdds){t+=o.c;if(roll<t)return o.r} }
function updateOpenPackBtn(){ const btn=document.getElementById("openPackBtn"); if(canOpenPack){btn.disabled=false;btn.classList.add("gold");} else{btn.disabled=true;btn.classList.remove("gold");} }
function generateTwoWordObject(){ return firstWords[Math.floor(Math.random()*firstWords.length)] + " " + secondWords[Math.floor(Math.random()*secondWords.length)]; }

// ===== PACK OPEN WITH FLY =====
async function openPack(){
  if(!canOpenPack||opening) return;
  opening=true; canOpenPack=false; updateOpenPackBtn();
  const rarity=rollRarity();
  const name=generateTwoWordObject();
  const card={name,rarity};

  // Create flying card
  const flyCard=document.createElement("div");
  flyCard.className=`card ${rarity} new`;
  flyCard.textContent=name;
  document.body.appendChild(flyCard);
  const startRect={x:window.innerWidth/2-50,y:150};
  flyCard.style.position="fixed";
  flyCard.style.left=startRect.x+"px";
  flyCard.style.top=startRect.y+"px";
  flyCard.style.width="90px"; flyCard.style.height="90px"; flyCard.style.zIndex=1000;

  // Destination
  const grid=document.getElementById("cardList");
  const tempDiv=document.createElement("div");
  grid.appendChild(tempDiv);
  const endRect=tempDiv.getBoundingClientRect();
  tempDiv.remove();

  const dx=endRect.left-startRect.x;
  const dy=endRect.top-startRect.y;

  flyCard.animate([{transform:"translate(0px,0px) scale(1)"},{transform:`translate(${dx}px,${dy}px) scale(1)`}],{duration:1000, easing:"ease-in-out"});
  await new Promise(r=>setTimeout(r,1000));

  flyCard.remove();
  inventory.push(card); save(); showInventory();
  if(["Legendary","Mystical","Magic","Artifact"].includes(rarity)) spawnConfetti(50);

  opening=false;
  loadQuestion();
}

// ===== INVENTORY =====
function showInventory(){
  const list=document.getElementById("cardList"); list.innerHTML="";
  if(sortMode==="rarity"){
    [...rarities].reverse().forEach(r=>{
      const group=inventory.filter(c=>c.rarity===r); if(!group.length) return;
      const h=document.createElement("div"); h.className="rarityHeader"; h.textContent=r; list.appendChild(h);
      group.forEach(c=>addCardDiv(c,list));
    });
  } else inventory.slice().reverse().forEach(c=>addCardDiv(c,list));
  showRarityChances();
  document.getElementById("stats").textContent=`Total Cards: ${inventory.length}`;
  updateFavorite();
}
function addCardDiv(card,list){
  const d=document.createElement("div"); d.className=`card ${card.rarity} interactive new`;
  d.textContent=card.name;
  d.onclick=()=>setFavorite(card);
  list.appendChild(d);
  setTimeout(()=>d.classList.remove("new"),700);
}
function setFavorite(card){ favorite=card; save(); updateFavorite(); }
function updateFavorite(){ const spot=document.getElementById("favoriteSpot"); if(!favorite){ spot.textContent="No favorite selected"; return;} spot.textContent=`‚≠ê Favorite: ${favorite.name} ‚Äî ${favorite.rarity}`; }

// Rarity chance
function showRarityChances(){
  const container=document.getElementById("rarityChances"); container.innerHTML="";
  rarityOdds.forEach(o=>{
    const div=document.createElement("div");
    div.className=`rarityLine ${o.r}`;
    div.textContent=`${o.r}: ${o.c}%`;
    container.appendChild(div);
  });
}

// ===== TRIVIA =====
async function loadQuestion(){
  canOpenPack=false; updateOpenPackBtn();
  const res=await fetch("https://the-trivia-api.com/v2/questions?limit=1");
  const q=(await res.json())[0]; correctAnswer=q.correctAnswer;
  document.getElementById("trivia").textContent=q.question.text;
  document.getElementById("answers").innerHTML="";
  document.getElementById("result").textContent="";
  [...q.incorrectAnswers,correctAnswer].sort(()=>Math.random()-.5).forEach(ans=>{
    const b=document.createElement("button"); b.textContent=ans; b.onclick=()=>checkAnswer(ans,b);
    document.getElementById("answers").appendChild(b);
  });
}
function checkAnswer(ans,btn){
  if(ans===correctAnswer){btn.classList.add("correct"); document.getElementById("result").textContent="‚úÖ Correct!"; canOpenPack=true; updateOpenPackBtn();}
  else{btn.classList.add("wrong"); document.getElementById("result").textContent=`‚ùå Wrong ‚Äî Correct: ${correctAnswer}`; canOpenPack=false; updateOpenPackBtn(); setTimeout(loadQuestion,1600);}
}

// ===== MISC =====
function resetGame(){ if(confirm("Reset all cards?")){inventory=[]; favorite=null; save(); showInventory(); canOpenPack=false; updateOpenPackBtn();}}
function toggleSort(){ sortMode=(sortMode==="rarity")?"recent":"rarity"; document.getElementById("sortBtn").textContent="Sort by: "+(sortMode==="rarity"?"Rarity":"Recent"); showInventory();}

// ===== CONFETTI =====
function spawnConfetti(count){ for(let i=0;i<count;i++){ const c=document.createElement("div"); c.className="confetti-piece"; c.style.background=`hsl(${Math.random()*360},80%,60%)`; c.style.left=Math.random()*100+"vw"; c.style.animationDuration=(1+Math.random()*1.5)+"s"; document.body.appendChild(c); setTimeout(()=>c.remove(),2500);} }
function spawnSparkles(){ for(let i=0;i<20;i++){ const s=document.createElement("div"); s.className="confetti-piece"; s.style.width="6px"; s.style.height="6px"; s.style.background="yellow"; s.style.left=50+Math.random()*100-50+"vw"; s.style.top=10+Math.random()*20+"vh"; document.body.appendChild(s); setTimeout(()=>s.remove(),800);} }

// ===== INIT =====
document.getElementById("openPackBtn").onclick=openPack;
showInventory();
loadQuestion();
</script>
</body>
</html>
